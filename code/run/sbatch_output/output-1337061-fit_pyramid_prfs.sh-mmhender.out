1337061
mind-1-5
#device: 0
numpy version: 1.21.2
USING DEBUG MODE...
texture_pyramid
['texture_pyramid']
texture_pyramid_ridge_4ori_4sf_pcaHL_fit_pRFs
Time Stamp: Nov-15-2022_2043_04

Will save final output file to /user_data/mmhender/texturemodel/model_fits/S01/texture_pyramid_ridge_4ori_4sf_pcaHL_fit_pRFs/Nov-15-2022_2043_04_DEBUG/

Loading data for sessions:
[1]
Data is located in: /lab_data/tarrlab/common/datasets/NSD/nsddata_betas/ppdata/subj01/func1pt8mm/betas_fithrf_GLMdenoise_RR...
Loading from /lab_data/tarrlab/common/datasets/NSD/nsddata_betas/ppdata/subj01/func1pt8mm/betas_fithrf_GLMdenoise_RR/betas_session01.nii.gz...
Raw data:
float64 -32768.0 32767.0 (750, 81, 104, 83)
Adjusted data (divided by 300):
float32 -109.22667 109.223335 (750, 699192)
z-scoring beta weights within this session...
mean = 1.242, sigma = 1.409

Size of full data set [n_trials x n_voxels] is:
(750, 19738)

After averaging - size of full data set [n_images x n_voxels] is:
(583, 19738)
loading train/holdout/val image list from /user_data/mmhender/nsd/stimuli/Image_data_partitions.npy

Possible lambda values are:
[0.0000000e+00 6.4989425e-02 5.5234134e-01 4.2069650e+00 3.1612778e+01
 2.3712740e+02 1.7782695e+03 1.3335206e+04 1.0000000e+05]
number of pRFs: 1456
most extreme RF positions:
[2.7755576e-17 0.0000000e+00 2.0000000e-02]
[ 0.7698996  -0.31890285  1.        ]
making feature loader with image set: S1
['full_model']
[125.]

Starting fitting for voxel mask 0 of 1, number of voxels this loop=19738
dtype = <class 'numpy.float32'>
device = cpu:0
Clearing features from memory
group inds:
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1]
(array([0, 1]), array([49, 76]))

Starting training (voxel subset 0 of 1)...

485
will z-score each column
Clearing features from memory

Processing prf 0 of 1456
Loading pre-computed features for models [0 - 99] from /user_data/mmhender/features/pyramid_texture/PCA/S1_4ori_4sf_pcaHL_concat_grid5.h5py
Took 3.73289 seconds to load file
Size of features array for this image set and batch is:
(536, 125, 100)
Number of nans in each prf this batch:
[3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 2, 4, 4, 4, 3, 5, 5, 3, 0, 2, 3, 2, 0, 3, 3, 3, 2, 4, 4, 5, 6, 5, 3, 4, 3, 4, 2, 3, 2, 4, 6, 3, 3, 6, 9, 10, 7, 8, 8, 6, 2, 4, 6, 5, 3, 4, 9, 3, 4, 4, 10, 10, 12, 11, 11, 6, 5, 4, 9, 7, 9, 6, 10, 5, 4, 10, 13, 8, 9, 8, 9, 10, 6, 6, 11, 9, 10, 9, 8, 10, 5, 13]
Index into batch for prf 0: 0
Final size of feature matrix for this image set and pRF is:
(536, 122)
prf 0 - using 485 training trials and 51 held-out trials

Fitting version 0 of 1: full_model, 

Processing prf 1 of 1456
Index into batch for prf 1: 1
Final size of feature matrix for this image set and pRF is:
(536, 122)
prf 1 - using 485 training trials and 51 held-out trials

Fitting version 0 of 1: full_model, 
Clearing features from memory
done with fitting
done with params
about to save

Saving to /user_data/mmhender/texturemodel/model_fits/S01/texture_pyramid_ridge_4ori_4sf_pcaHL_fit_pRFs/Nov-15-2022_2043_04_DEBUG/all_fit_params.npy

dict_keys(['subject', 'volume_space', 'fitting_types', 'voxel_mask', 'average_image_reps', 'brain_nii_shape', 'image_order', 'voxel_index', 'voxel_roi', 'voxel_ncsnr', 'which_prf_grid', 'prfs_fixed_sigma', 'models', 'best_losses', 'best_lambdas', 'best_params', 'lambdas', 'val_cc', 'val_r2', 'partial_masks', 'partial_version_names', 'zscore_features', 'ridge', 'set_lambda_per_group', 'debug', 'up_to_sess', 'single_sess', 'use_precomputed_prfs', 'saved_prfs_fn', 'best_layer_each_voxel', 'saved_best_layer_fn', 'voxel_subset_is_done_trn', 'voxel_subset_is_done_val', 'trial_subset', 'do_corrcoef', 'pyr_pca_type', 'group_all_hl_feats', 'do_pyr_varpart'])
Starting validation (voxel subset 0 of 1)...

about to preallocate arrays
made arrays
Clearing features from memory
Getting features for prf 0 of 1456
about to load features
Loading pre-computed features for models [0 - 99] from /user_data/mmhender/features/pyramid_texture/PCA/S1_4ori_4sf_pcaHL_concat_grid5.h5py
Took 3.72740 seconds to load file
Size of features array for this image set and batch is:
(47, 125, 100)
Number of nans in each prf this batch:
[3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 2, 4, 4, 4, 3, 5, 5, 3, 0, 2, 3, 2, 0, 3, 3, 3, 2, 4, 4, 5, 6, 5, 3, 4, 3, 4, 2, 3, 2, 4, 6, 3, 3, 6, 9, 10, 7, 8, 8, 6, 2, 4, 6, 5, 3, 4, 9, 3, 4, 4, 10, 10, 12, 11, 11, 6, 5, 4, 9, 7, 9, 6, 10, 5, 4, 10, 13, 8, 9, 8, 9, 10, 6, 6, 11, 9, 10, 9, 8, 10, 5, 13]
Index into batch for prf 0: 0
Final size of feature matrix for this image set and pRF is:
(47, 122)
loaded features
prf 0: using 47 validation set trials
Getting predictions for voxel batch 0 of 18

Evaluating version 0 of 1: full_model
Includes 125 features

Evaluating version 0 of 1: full_model
Includes 125 features
Getting features for prf 1 of 1456
about to load features
Index into batch for prf 1: 1
Final size of feature matrix for this image set and pRF is:
(47, 122)
loaded features
prf 1: using 47 validation set trials
Getting predictions for voxel batch 0 of 3

Evaluating version 0 of 1: full_model
Includes 125 features

Evaluating version 0 of 1: full_model
Includes 125 features
Clearing features from memory

Saving to /user_data/mmhender/texturemodel/model_fits/S01/texture_pyramid_ridge_4ori_4sf_pcaHL_fit_pRFs/Nov-15-2022_2043_04_DEBUG/all_fit_params.npy

dict_keys(['subject', 'volume_space', 'fitting_types', 'voxel_mask', 'average_image_reps', 'brain_nii_shape', 'image_order', 'voxel_index', 'voxel_roi', 'voxel_ncsnr', 'which_prf_grid', 'prfs_fixed_sigma', 'models', 'best_losses', 'best_lambdas', 'best_params', 'lambdas', 'val_cc', 'val_r2', 'partial_masks', 'partial_version_names', 'zscore_features', 'ridge', 'set_lambda_per_group', 'debug', 'up_to_sess', 'single_sess', 'use_precomputed_prfs', 'saved_prfs_fn', 'best_layer_each_voxel', 'saved_best_layer_fn', 'voxel_subset_is_done_trn', 'voxel_subset_is_done_val', 'trial_subset', 'do_corrcoef', 'pyr_pca_type', 'group_all_hl_feats', 'do_pyr_varpart'])
